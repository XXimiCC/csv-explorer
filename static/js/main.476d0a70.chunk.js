(this["webpackJsonpcsv-explorer"]=this["webpackJsonpcsv-explorer"]||[]).push([[0],{126:function(e,t,a){e.exports={NavbarWrapper:"Navbar_NavbarWrapper__1Fhyk"}},131:function(e,t,a){e.exports={savedMark:"SettingsForm_savedMark__9WRh6"}},137:function(e,t,a){e.exports=a(281)},142:function(e,t,a){},143:function(e,t,a){},281:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(13),c=a.n(l),o=(a(142),a(37)),s=a(38),i=a(40),u=a(39),m=a(41),d=(a(143),a(126)),E=a.n(d),f=a(19),v=function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"".concat(E.a.NavbarWrapper," mb-5")},r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light"},r.a.createElement(f.b,{to:"/",exact:!0,className:"navbar-brand"},"CSV Explorer"),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse position-relative",id:"navbarNav"},r.a.createElement("ul",{className:"navbar-nav ml-auto"},r.a.createElement(f.b,{to:"/",exact:!0,className:"nav-link"},"Home"),r.a.createElement("li",{className:"nav-item"},r.a.createElement(f.b,{to:"/changes",exact:!0,className:"nav-link"},"Changes")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(f.b,{to:"/settings",exact:!0,className:"nav-link"},"Settings"))))))}}]),t}(n.Component),b=function(e){var t=e.fluid?"container-fluid":"container";return r.a.createElement(r.a.Fragment,null,r.a.createElement(v,null),r.a.createElement("div",{className:t},e.children))},p=a(46),h=a(135),g=a(81),O="SAVE_NEW_DOWNLOAD_URL",N="RESTORE_DOWNLOAD_URL",S="DOWNLOAD_QUERIES_CSV_REQUEST",j="DOWNLOAD_QUERIES_CSV_SUCCESS",w="DOWNLOAD_QUERIES_CSV_FAILURE",y="DOWNLOAD_URL",_="PREVIOUS_LIST_OF_QUERIES";var L=a(14),C=a(285),x=a(131),D=a.n(x);var R=Object(L.b)((function(e){return{downloadUrl:e.settings.downloadUrl}}),(function(e){return{saveNewDownloadUrl:function(t){return e(function(e){try{localStorage.setItem(y,e)}catch(t){return void alert("LocalStorage Save Error")}return{type:O,url:e}}(t))}}}))((function(e){var t=e.downloadUrl,a=e.saveNewDownloadUrl,l=Object(n.useState)(!1),c=Object(p.a)(l,2),o=c[0],s=c[1],i=Object(h.a)({initialValues:{url:t},validationSchema:g.object().shape({url:g.string().url().required()}),onSubmit:function(e){s(!0),a(e.url),setTimeout((function(){s(!1)}),1e3)}}),u=i.errors.url&&i.touched.url;return r.a.createElement("form",{onSubmit:i.handleSubmit},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"url"},"URL to CSV File"),r.a.createElement("input",{type:"text",className:"form-control ".concat(u?"is-invalid":""),name:"url",id:"url",onBlur:i.handleBlur,onChange:i.handleChange,value:i.values.url,autoComplete:"off"}),u&&r.a.createElement("small",{className:"invalid-feedback"},i.errors.url)),r.a.createElement("button",{className:"btn btn-primary mr-2",type:"submit",disabled:!i.isValid},"Save"),r.a.createElement(C.a,{in:o,timeout:500},(function(e){return r.a.createElement("span",{className:"text-muted red ".concat(D.a.savedMark," ").concat(e)},"Saved...")})))})),U=function(e){return r.a.createElement(b,null,r.a.createElement("h3",null,"Settings"),r.a.createElement(R,null))},k=a(5),T=a(136),F=a(45),V=function(e){var t=Object(n.createRef)();if(Object(n.useEffect)((function(){var a=F(t.current);return a.modal().on("hidden.bs.modal",e.closeHandler),function(){a.modal("dispose")}}),[t,e.closeHandler]),!e.show)return null;var a=r.a.createElement("div",{className:"modal fade",role:"dialog",ref:t},r.a.createElement("div",{className:"modal-dialog modal-dialog-scrollable",role:"document"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("div",{className:"modal-header"},r.a.createElement("h5",{className:"modal-title",id:"exampleModalScrollableTitle"},e.title),r.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),r.a.createElement("div",{className:"modal-body"},e.children),r.a.createElement("div",{className:"modal-footer"},r.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Close")))));return c.a.createPortal(a,document.getElementById("modal-root"))},q=a(132),I=a.n(q),Q=function(e){var t=e.json,a=Object(T.a)(e,["json"]),l=Object(n.createRef)();return Object(n.useEffect)((function(){if(t){var e=F(l.current);try{var a=new I.a(JSON.parse(t));e.html(""),e.append(a.render())}catch(n){e.html("INVALID JSON")}}}),[l,t]),r.a.createElement(V,a,r.a.createElement("div",{ref:l}))},A=function(e){var t=e.data,a=Object(n.useState)(!1),l=Object(p.a)(a,2),c=l[0],o=l[1],s=Object(n.useState)(""),i=Object(p.a)(s,2),u=i[0],m=i[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(Q,{show:c,closeHandler:function(){return o(!1)},json:u}),r.a.createElement("table",{className:"table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"#"),r.a.createElement("th",null,"Request"),r.a.createElement("th",null,"Description"),r.a.createElement("th",null,"Parameters"),r.a.createElement("th",null,"Parameters Update"),r.a.createElement("th",null,"Role"))),r.a.createElement("tbody",null,t.map((function(e,t){return e.errorMessage?function(e,t){return r.a.createElement("tr",{key:t},r.a.createElement("td",null,t+1),r.a.createElement("td",{colSpan:"5",className:"text-danger"},"Parsing ERROR: ",e.errorMessage))}(e,t):function(e,t){return r.a.createElement("tr",{key:t},r.a.createElement("td",null,t+1),r.a.createElement("td",null,e.request),r.a.createElement("td",null,e.description),r.a.createElement("td",null,r.a.createElement("button",{className:"btn btn-link",onClick:function(){o(!0),m(e.parameters)}},e.parameters.slice(0,25).concat("..."))),r.a.createElement("td",null,e.parameters_update),r.a.createElement("td",null,e.role.map((function(e,t){return r.a.createElement("span",{className:"badge badge-info mr-1",key:t},e)}))))}(e,t)})))))},W=a(83),P=a.n(W),M=a(133);function J(e){return new Promise((function(t,a){M.parse(e,{delimiter:";",download:!0,header:!0,skipEmptyLines:!0,transform:function(e,t){switch(t){case"role":return e.split(" ");case"parameters_update":return new Date(e).toLocaleString("ru");default:return e}},complete:function(e){var a=e.errors,n=e.data;a.length&&a.forEach((function(e){n[e.row].errorMessage=e.message})),t(n)},error:function(e){a(e)}})}))}var B=a(15);function H(e){try{localStorage.setItem(_,JSON.stringify(e))}catch(t){alert("Data is too large to storing in localstorage")}}function X(e){var t=localStorage.getItem(_),a=t&&JSON.parse(t);return a?B.filter(e,(function(e,t){return!a[t]||JSON.stringify(e)!==JSON.stringify(a[t])})):[]}var z=a(84),$=a.n(z),G=function(e){if(!1===e.show)return null;var t=r.a.createElement("div",{className:$.a.ldsRing},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null)),a=r.a.createElement("div",{className:$.a.overlay}),n=r.a.createElement(r.a.Fragment,null,t,a);return c.a.createPortal(n,document.getElementById("modal-root"))},K=function(e){function t(){var e,a;Object(o.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={searchTerm:"",searchRole:"",filteredQueries:[]},a.onFilterChange=function(e){a.setState(Object(k.a)({},e.currentTarget.name,e.currentTarget.value),(function(){a.filterQueries()}))},a.clearFilters=function(){a.setState({searchTerm:"",searchRole:""},(function(){return a.filterQueries()}))},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e,t,a){this.props.queries!==e.queries&&this.filterQueries()}},{key:"componentDidMount",value:function(){this.filterQueries()}},{key:"filterQueries",value:function(){var e=this.state.searchRole,t=this.state.searchTerm;if(e||t){var a=B.filter(this.props.queries,(function(a){var n=!!B.find(["request","description","parameters","parameters_update"],(function(e){return a[e]&&-1!==a[e].indexOf(t)})),r=!e||a.role&&a.role.includes(e);return n&&r}));this.setState({filteredQueries:a})}else this.setState({filteredQueries:this.props.queries})}},{key:"render",value:function(){var e=this.props,t=e.downloadQueriesCSV,a=e.isLoading,n=e.downloadError,l=this.state.filteredQueries,c=!(!this.props.queries.length||n),o=r.a.createElement("div",{className:"row mb-3"},r.a.createElement("div",{className:"col-md-3"},r.a.createElement("input",{className:"form-control",name:"searchTerm",type:"text",value:this.state.searchTerm,onChange:this.onFilterChange,placeholder:"Search by text fields"})),r.a.createElement("div",{className:"col-md-3"},r.a.createElement("select",{name:"searchRole",className:"form-control",placeholder:"Role Filter",value:this.state.searchRole,onChange:this.onFilterChange},r.a.createElement("option",{value:""}),this.props.roles.map((function(e){return r.a.createElement("option",{value:e,key:e},e)})))),r.a.createElement("button",{className:"btn btn-secondary",onClick:this.clearFilters},"Clear"));return r.a.createElement(b,null,a&&r.a.createElement(G,null),r.a.createElement("div",{className:"d-flex justify-content-between d-flex align-items-center mb-3"},r.a.createElement("h3",{className:"m-0"},"CSV Data"),r.a.createElement("button",{className:"btn btn-primary",onClick:B.debounce((function(){return t()}),250)},"Download CSV")),n&&r.a.createElement("p",{className:"text-center text-danger"},"Download CSV Error: ",n.message),c&&o,c&&r.a.createElement(A,{data:l}))}}]),t}(r.a.Component);var Y=Object(L.b)((function(e){return{queries:e.queries.list,isLoading:e.queries.isLoading,roles:e.queries.roles,downloadError:e.queries.downloadError}}),(function(e){return{downloadQueriesCSV:function(){return e((function(e,t){var a,n;return P.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return e({type:S}),a=t().settings.downloadUrl,r.prev=2,r.next=5,P.a.awrap(J(a));case 5:n=r.sent,e({type:j,data:n,changes:X(n),roles:(l=n,B.compact(B.uniq(B.flatMap(B.map(l,"role")))))}),H(n),r.next=14;break;case 10:r.prev=10,r.t0=r.catch(2),e({type:w,error:r.t0}),console.log("downloadQueriesCSV error:",r.t0);case 14:case"end":return r.stop()}var l}),null,null,[[2,10]])}))}}}))(K);var Z=Object(L.b)((function(e){return{changes:e.queries.changes}}),(function(e){return{}}))((function(e){return r.a.createElement(b,null,r.a.createElement("h3",null,"Changes Page"),e.changes.length?r.a.createElement(A,{data:e.changes}):r.a.createElement("p",{className:"text-center"},"No Changes"))})),ee=a(22),te=function(e){function t(e){var a;return Object(o.a)(this,t),a=Object(i.a)(this,Object(u.a)(t).call(this,e)),e.restoreDownloadUrl(),a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(ee.d,null,r.a.createElement(ee.b,{path:"/",exact:!0,component:Y}),r.a.createElement(ee.b,{path:"/changes",exact:!0,component:Z}),r.a.createElement(ee.b,{path:"/settings",exact:!0,component:U}),r.a.createElement(ee.a,{to:"/"})))}}]),t}(r.a.Component);var ae=Object(L.b)((function(e){return{}}),(function(e){return{restoreDownloadUrl:function(){return e(function(){var e=localStorage.getItem(y)||"https://mindless-corps.000webhostapp.com/file.csv";return{type:N,url:e}}())}}}))(te);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(278),a(279);var ne,re=a(21),le=a(134),ce=a(23);var oe,se={downloadUrl:""},ie=(ne={},Object(k.a)(ne,N,(function(e,t){return Object(ce.a)({},e,{downloadUrl:t.url})})),Object(k.a)(ne,O,(function(e,t){return Object(ce.a)({},e,{downloadUrl:t.url})})),Object(k.a)(ne,j,(function(e,t){return Object(ce.a)({},e,{data:t.data,isLoading:!1,downloadError:null})})),Object(k.a)(ne,"DEFAULT",(function(e){return e})),ne);var ue={isLoading:!1,list:[],roles:[],changes:[],downloadError:null},me=(oe={},Object(k.a)(oe,S,(function(e){return Object(ce.a)({},e,{isLoading:!0})})),Object(k.a)(oe,w,(function(e,t){return Object(ce.a)({},e,{isLoading:!1,downloadError:t.error})})),Object(k.a)(oe,j,(function(e,t){return Object(ce.a)({},e,{list:t.data,changes:t.changes,roles:t.roles,isLoading:!1,downloadError:null})})),Object(k.a)(oe,"DEFAULT",(function(e){return e})),oe);var de=Object(re.c)({settings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:se,t=arguments.length>1?arguments[1]:void 0;return(ie[t.type]||ie.DEFAULT)(e,t)},queries:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ue,t=arguments.length>1?arguments[1]:void 0;return(me[t.type]||me.DEFAULT)(e,t)}}),Ee=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||re.d,fe=Object(re.e)(de,Ee(Object(re.a)(le.a))),ve=r.a.createElement(L.a,{store:fe},r.a.createElement(f.a,{basename:"/csv-explorer"},r.a.createElement(ae,null)));c.a.render(ve,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},84:function(e,t,a){e.exports={ldsRing:"Loader_ldsRing__3PgLk","lds-ring":"Loader_lds-ring__32zUL",overlay:"Loader_overlay__17bnT",local:"Loader_local__Pa0AV"}}},[[137,1,2]]]);
//# sourceMappingURL=main.476d0a70.chunk.js.map