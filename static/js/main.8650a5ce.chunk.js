(this["webpackJsonpcsv-explorer"]=this["webpackJsonpcsv-explorer"]||[]).push([[0],{127:function(e,t,a){e.exports={NavbarWrapper:"Navbar_NavbarWrapper__1Fhyk"}},132:function(e,t,a){e.exports={savedMark:"SettingsForm_savedMark__9WRh6"}},137:function(e,t,a){e.exports=a(281)},142:function(e,t,a){},143:function(e,t,a){},281:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(13),o=a.n(l),c=(a(142),a(19)),s=a(20),i=a(22),u=a(21),m=a(23),d=(a(143),a(127)),E=a.n(d),f=a(24),b=function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"".concat(E.a.NavbarWrapper," mb-5")},r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light"},r.a.createElement(f.b,{to:"/",exact:!0,className:"navbar-brand"},"CSV Explorer"),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarNav","aria-controls":"navbarNav","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse position-relative",id:"navbarNav"},r.a.createElement("ul",{className:"navbar-nav ml-auto"},r.a.createElement(f.b,{to:"/",exact:!0,className:"nav-link"},"Home"),r.a.createElement("li",{className:"nav-item"},r.a.createElement(f.b,{to:"/changes",exact:!0,className:"nav-link"},"Changes")),r.a.createElement("li",{className:"nav-item"},r.a.createElement(f.b,{to:"/settings",exact:!0,className:"nav-link"},"Settings"))))))}}]),t}(n.Component),h=function(e){var t=e.fluid?"container-fluid":"container";return r.a.createElement(r.a.Fragment,null,r.a.createElement(b,null),r.a.createElement("div",{className:t},e.children))},p=a(46),v=a(135),g=a(82),O="SAVE_NEW_DOWNLOAD_URL",N="RESTORE_DOWNLOAD_URL",y="DOWNLOAD_QUERIES_CSV_REQUEST",S="DOWNLOAD_QUERIES_CSV_SUCCESS",_="DOWNLOAD_QUERIES_CSV_FAILURE",j="DOWNLOAD_URL",w="PREVIOUS_LIST_OF_QUERIES";var C=a(14),k=a(285),R=a(132),L=a.n(R);var x=Object(C.b)((function(e){return{downloadUrl:e.settings.downloadUrl}}),(function(e){return{saveNewDownloadUrl:function(t){return e(function(e){try{localStorage.setItem(j,e)}catch(t){return void alert("LocalStorage Save Error")}return{type:O,url:e}}(t))}}}))((function(e){var t=e.downloadUrl,a=e.saveNewDownloadUrl,l=Object(n.useState)(!1),o=Object(p.a)(l,2),c=o[0],s=o[1],i=Object(v.a)({initialValues:{url:t},validationSchema:g.object().shape({url:g.string().url().required()}),onSubmit:function(e){s(!0),a(e.url),setTimeout((function(){s(!1)}),1e3)}}),u=i.errors.url&&i.touched.url;return r.a.createElement("form",{onSubmit:i.handleSubmit},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"url"},"URL to CSV File"),r.a.createElement("input",{type:"text",className:"form-control ".concat(u?"is-invalid":""),name:"url",id:"url",onBlur:i.handleBlur,onChange:i.handleChange,value:i.values.url,autoComplete:"off"}),u&&r.a.createElement("small",{className:"invalid-feedback"},i.errors.url)),r.a.createElement("button",{className:"btn btn-primary mr-2",type:"submit",disabled:!i.isValid},"Save"),r.a.createElement(k.a,{in:c,timeout:500},(function(e){return r.a.createElement("span",{className:"text-muted red ".concat(L.a.savedMark," ").concat(e)},"Saved...")})))})),D=function(e){return r.a.createElement(h,null,r.a.createElement("h3",null,"Settings"),r.a.createElement(x,null))},U=a(5),F=a(136),P=a(78),T=function(e){var t=Object(n.createRef)();if(Object(n.useEffect)((function(){var a=P(t.current);return a.modal().on("hidden.bs.modal",e.closeHandler),function(){a.modal("dispose")}}),[t,e.closeHandler]),!e.show)return null;var a=r.a.createElement("div",{className:"modal fade",role:"dialog",ref:t},r.a.createElement("div",{className:"modal-dialog modal-dialog-scrollable",role:"document"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("div",{className:"modal-header"},r.a.createElement("h5",{className:"modal-title",id:"exampleModalScrollableTitle"},e.title),r.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),r.a.createElement("div",{className:"modal-body"},e.children),r.a.createElement("div",{className:"modal-footer"},r.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Close")))));return o.a.createPortal(a,document.getElementById("modal-root"))},A=a(30),V=a.n(A),Q=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={Object:void 0===e.root},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"renderRow",value:function(e,a,n){var l=this,o=typeof a,c="object"===o,s=Array.isArray(a),i=r.a.createElement(r.a.Fragment,null,r.a.createElement("button",{className:"".concat(V.a.withChildren),onClick:function(){return l.toggleRow(e)}},r.a.createElement("span",{className:"mr-1 ".concat(V.a.key)},e,":"),r.a.createElement("span",{className:V.a[o]},s?"Array[".concat(a.length,"]"):"Object")),this.state[e]&&r.a.createElement(t,{data:a,root:!1})),u=r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"mr-1 ".concat(V.a.key)},e,":"),r.a.createElement("span",{className:V.a[o]},"string"===o?'"'.concat(a,'"'):a.toString()));return r.a.createElement("div",{className:"ml-3 ".concat(V.a.PrettifyRow," ").concat(this.state[e]?V.a.open:""),key:n},c?i:u)}},{key:"toggleRow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"root";this.setState(Object(U.a)({},e,!this.state[e]))}},{key:"render",value:function(){var e=this,t=this.props.data;return(void 0===this.props.root||this.props.root)&&(t={Object:t}),r.a.createElement(r.a.Fragment,null,Object.keys(t).map((function(a,n){return e.renderRow(a,t[a],n)})))}}]),t}(r.a.Component),q=function(e){var t=e.json,a=Object(F.a)(e,["json"]),n=null;if(!t)return null;try{var l=JSON.parse(t);n=r.a.createElement(Q,{data:l})}catch(o){n="INVALID JSON"}return r.a.createElement(T,a,n)},I=function(e){var t=e.data,a=Object(n.useState)(!1),l=Object(p.a)(a,2),o=l[0],c=l[1],s=Object(n.useState)(""),i=Object(p.a)(s,2),u=i[0],m=i[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(q,{show:o,closeHandler:function(){return c(!1)},json:u}),r.a.createElement("table",{className:"table"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"#"),r.a.createElement("th",null,"Request"),r.a.createElement("th",null,"Description"),r.a.createElement("th",null,"Parameters"),r.a.createElement("th",null,"Parameters Update"),r.a.createElement("th",null,"Role"))),r.a.createElement("tbody",null,t.map((function(e,t){return e.errorMessage?function(e,t){return r.a.createElement("tr",{key:t},r.a.createElement("td",null,t+1),r.a.createElement("td",{colSpan:"5",className:"text-danger"},"Parsing ERROR: ",e.errorMessage))}(e,t):function(e,t){return r.a.createElement("tr",{key:t},r.a.createElement("td",null,t+1),r.a.createElement("td",null,e.request),r.a.createElement("td",null,e.description),r.a.createElement("td",null,r.a.createElement("button",{className:"btn btn-link",onClick:function(){c(!0),m(e.parameters)}},e.parameters.slice(0,25).concat("..."))),r.a.createElement("td",null,e.parameters_update),r.a.createElement("td",null,e.role.map((function(e,t){return r.a.createElement("span",{className:"badge badge-info mr-1",key:t},e)}))))}(e,t)})))))},J=a(84),W=a.n(J),M=a(133);function B(e){return new Promise((function(t,a){M.parse(e,{delimiter:";",download:!0,header:!0,skipEmptyLines:!0,transform:function(e,t){switch(t){case"role":return e.split(" ");case"parameters_update":return new Date(e).toLocaleString("ru");default:return e}},complete:function(e){var a=e.errors,n=e.data;a.length&&a.forEach((function(e){n[e.row].errorMessage=e.message})),t(n)},error:function(e){a(e)}})}))}var H=a(15);function X(e){try{localStorage.setItem(w,JSON.stringify(e))}catch(t){alert("Data is too large to storing in localstorage")}}function z(e){var t=localStorage.getItem(w),a=t&&JSON.parse(t);return a?H.filter(e,(function(e,t){return!a[t]||JSON.stringify(e)!==JSON.stringify(a[t])})):[]}var $=a(85),G=a.n($),K=function(e){if(!1===e.show)return null;var t=r.a.createElement("div",{className:G.a.ldsRing},r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null),r.a.createElement("div",null)),a=r.a.createElement("div",{className:G.a.overlay}),n=r.a.createElement(r.a.Fragment,null,t,a);return o.a.createPortal(n,document.getElementById("modal-root"))},Y=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={searchTerm:"",searchRole:"",filteredQueries:[]},a.onFilterChange=function(e){a.setState(Object(U.a)({},e.currentTarget.name,e.currentTarget.value),(function(){a.filterQueries()}))},a.clearFilters=function(){a.setState({searchTerm:"",searchRole:""},(function(){return a.filterQueries()}))},a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidUpdate",value:function(e,t,a){this.props.queries!==e.queries&&this.filterQueries()}},{key:"componentDidMount",value:function(){this.filterQueries()}},{key:"filterQueries",value:function(){var e=this.state.searchRole,t=this.state.searchTerm;if(e||t){var a=H.filter(this.props.queries,(function(a){var n=!!H.find(["request","description","parameters","parameters_update"],(function(e){return a[e]&&-1!==a[e].indexOf(t)})),r=!e||a.role&&a.role.includes(e);return n&&r}));this.setState({filteredQueries:a})}else this.setState({filteredQueries:this.props.queries})}},{key:"render",value:function(){var e=this.props,t=e.downloadQueriesCSV,a=e.isLoading,n=e.downloadError,l=this.state.filteredQueries,o=!(!this.props.queries.length||n),c=r.a.createElement("div",{className:"row mb-3"},r.a.createElement("div",{className:"col-md-3"},r.a.createElement("input",{className:"form-control",name:"searchTerm",type:"text",value:this.state.searchTerm,onChange:this.onFilterChange,placeholder:"Search by text fields"})),r.a.createElement("div",{className:"col-md-3"},r.a.createElement("select",{name:"searchRole",className:"form-control",placeholder:"Role Filter",value:this.state.searchRole,onChange:this.onFilterChange},r.a.createElement("option",{value:""}),this.props.roles.map((function(e){return r.a.createElement("option",{value:e,key:e},e)})))),r.a.createElement("button",{className:"btn btn-secondary",onClick:this.clearFilters},"Clear"));return r.a.createElement(h,null,a&&r.a.createElement(K,null),r.a.createElement("div",{className:"d-flex justify-content-between d-flex align-items-center mb-3"},r.a.createElement("h3",{className:"m-0"},"CSV Data"),r.a.createElement("button",{className:"btn btn-primary",onClick:H.debounce((function(){return t()}),250)},"Download CSV")),n&&r.a.createElement("p",{className:"text-center text-danger"},"Download CSV Error: ",n.message),o&&c,o&&r.a.createElement(I,{data:l}))}}]),t}(r.a.Component);var Z=Object(C.b)((function(e){return{queries:e.queries.list,isLoading:e.queries.isLoading,roles:e.queries.roles,downloadError:e.queries.downloadError}}),(function(e){return{downloadQueriesCSV:function(){return e((function(e,t){var a,n;return W.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return e({type:y}),a=t().settings.downloadUrl,r.prev=2,r.next=5,W.a.awrap(B(a));case 5:n=r.sent,e({type:S,data:n,changes:z(n),roles:(l=n,H.compact(H.uniq(H.flatMap(H.map(l,"role")))))}),X(n),r.next=14;break;case 10:r.prev=10,r.t0=r.catch(2),e({type:_,error:r.t0}),console.log("downloadQueriesCSV error:",r.t0);case 14:case"end":return r.stop()}var l}),null,null,[[2,10]])}))}}}))(Y);var ee=Object(C.b)((function(e){return{changes:e.queries.changes}}),(function(e){return{}}))((function(e){return r.a.createElement(h,null,r.a.createElement("h3",null,"Changes Page"),e.changes.length?r.a.createElement(I,{data:e.changes}):r.a.createElement("p",{className:"text-center"},"No Changes"))})),te=a(27),ae=function(e){function t(e){var a;return Object(c.a)(this,t),a=Object(i.a)(this,Object(u.a)(t).call(this,e)),e.restoreDownloadUrl(),a}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(te.d,null,r.a.createElement(te.b,{path:"/",exact:!0,component:Z}),r.a.createElement(te.b,{path:"/changes",exact:!0,component:ee}),r.a.createElement(te.b,{path:"/settings",exact:!0,component:D}),r.a.createElement(te.a,{to:"/"})))}}]),t}(r.a.Component);var ne=Object(C.b)((function(e){return{}}),(function(e){return{restoreDownloadUrl:function(){return e(function(){var e=localStorage.getItem(j)||"https://mindless-corps.000webhostapp.com/file.csv";return{type:N,url:e}}())}}}))(ae);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(278),a(279);var re,le=a(26),oe=a(134),ce=a(28);var se,ie={downloadUrl:""},ue=(re={},Object(U.a)(re,N,(function(e,t){return Object(ce.a)({},e,{downloadUrl:t.url})})),Object(U.a)(re,O,(function(e,t){return Object(ce.a)({},e,{downloadUrl:t.url})})),Object(U.a)(re,S,(function(e,t){return Object(ce.a)({},e,{data:t.data,isLoading:!1,downloadError:null})})),Object(U.a)(re,"DEFAULT",(function(e){return e})),re);var me={isLoading:!1,list:[],roles:[],changes:[],downloadError:null},de=(se={},Object(U.a)(se,y,(function(e){return Object(ce.a)({},e,{isLoading:!0})})),Object(U.a)(se,_,(function(e,t){return Object(ce.a)({},e,{isLoading:!1,downloadError:t.error})})),Object(U.a)(se,S,(function(e,t){return Object(ce.a)({},e,{list:t.data,changes:t.changes,roles:t.roles,isLoading:!1,downloadError:null})})),Object(U.a)(se,"DEFAULT",(function(e){return e})),se);var Ee=Object(le.c)({settings:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie,t=arguments.length>1?arguments[1]:void 0;return(ue[t.type]||ue.DEFAULT)(e,t)},queries:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:me,t=arguments.length>1?arguments[1]:void 0;return(de[t.type]||de.DEFAULT)(e,t)}}),fe=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||le.d,be=Object(le.e)(Ee,fe(Object(le.a)(oe.a))),he=r.a.createElement(C.a,{store:be},r.a.createElement(f.a,{basename:"/csv-explorer"},r.a.createElement(ne,null)));o.a.render(he,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},30:function(e,t,a){e.exports={PrettifyRow:"JSONPrettify_PrettifyRow__m0zjC",key:"JSONPrettify_key__v9P5k",string:"JSONPrettify_string__2uctD",number:"JSONPrettify_number__2cCa9",boolean:"JSONPrettify_boolean__36QX8",withChildren:"JSONPrettify_withChildren__unECx",open:"JSONPrettify_open__1FVth"}},85:function(e,t,a){e.exports={ldsRing:"Loader_ldsRing__3PgLk","lds-ring":"Loader_lds-ring__32zUL",overlay:"Loader_overlay__17bnT",local:"Loader_local__Pa0AV"}}},[[137,1,2]]]);
//# sourceMappingURL=main.8650a5ce.chunk.js.map